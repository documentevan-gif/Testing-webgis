<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <title>WebGIS Surakarta - Professional Planning</title>
        
        <link rel="stylesheet" href="css/leaflet.css">
        <link rel="stylesheet" href="css/L.Control.Layers.Tree.css">
        <link rel="stylesheet" href="css/L.Control.Locate.min.css">
        <link rel="stylesheet" href="css/qgis2web.css">
        <link rel="stylesheet" href="css/fontawesome-all.min.css">
        <link rel="stylesheet" href="css/leaflet-measure.css">
        
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
        <style>
            body, html { height: 100%; margin: 0; overflow: hidden; font-family: 'Inter', sans-serif; }
            #container { display: flex; height: 100vh; width: 100vw; }
            #sidebar { width: 320px; background: #1a1c23; color: #fff; z-index: 1001; display: flex; flex-direction: column; box-shadow: 2px 0 10px rgba(0,0,0,0.3); }
            #map { flex: 1; position: relative; }
            .sidebar-header { padding: 1.5rem; border-bottom: 1px solid #30363d; background: #24292e; }
            .sidebar-content { padding: 1rem; flex: 1; overflow-y: auto; }
            .legend-box { background: #2d333b; border-radius: 8px; padding: 12px; margin-top: 15px; font-size: 0.8rem; }
            .color-box { width: 14px; height: 14px; display: inline-block; margin-right: 8px; border-radius: 2px; }
            
            /* Modernize Leaflet Controls */
            .leaflet-bar { border: none !important; box-shadow: 0 2px 6px rgba(0,0,0,0.2) !important; }
        </style>
    </head>
    <body>

    <div id="container">
        <aside id="sidebar">
            <div class="sidebar-header text-center">
                <h6 class="mb-1 text-uppercase tracking-wider">Clockboard Zone</h6>
                <p class="small text-muted mb-0">WebGIS Perencanaan Surakarta</p>
            </div>
            <div class="sidebar-content">
                <div class="alert alert-warning py-2 small" role="alert">
                    <i class="fas fa-arrows-alt-h me-2"></i> Geser slider di peta untuk membandingkan layer.
                </div>
                
                <h6 class="mt-3 small text-uppercase">Legenda Analisis MCE</h6>
                <div class="legend-box">
                    <div class="mb-1"><span class="color-box" style="background:#2b83ba"></span> Sangat Tinggi</div>
                    <div class="mb-1"><span class="color-box" style="background:#abdeb4"></span> Tinggi</div>
                    <div class="mb-1"><span class="color-box" style="background:#ffffbf"></span> Sedang</div>
                    <div class="mb-1"><span class="color-box" style="background:#fdae61"></span> Rendah</div>
                    <div class="mb-1"><span class="color-box" style="background:#d7191c"></span> Sangat Rendah</div>
                </div>
            </div>
            <div class="p-3 bg-dark mt-auto text-center small text-muted">PWK Surakarta &copy; 2025</div>
        </aside>

        <main id="map"></main>
    </div>

    <script src="js/qgis2web_expressions.js"></script>
    <script src="js/leaflet.js"></script>
    <script src="js/L.Control.Layers.Tree.min.js"></script>
    <script src="js/L.Control.Locate.min.js"></script>
    <script src="js/leaflet.rotatedMarker.js"></script>
    <script src="js/leaflet.pattern.js"></script>
    <script src="js/leaflet-hash.js"></script>
    <script src="js/Autolinker.min.js"></script>
    <script src="js/rbush.min.js"></script>
    <script src="js/labelgun.min.js"></script>
    <script src="js/labels.js"></script>
    <script src="js/leaflet-measure.js"></script>
    
    <script src="data/MultiCriteriaEvaluationSurakarta_3.js"></script>
    <script src="data/AnalisisClockboardZoneSurakarta_4.js"></script>
    <script src="data/BatasAdminSurakarta_5.js"></script>

    <script src="https://cdn.jsdelivr.net/gh/murb/leaflet-side-by-side@master/leaflet-side-by-side.js"></script>

    <script>
        var map = L.map('map', {
            zoomControl: false, maxZoom: 28, minZoom: 1
        }).fitBounds([[-7.597, 110.766],[-7.520, 110.871]]);

        // 1. Inisialisasi Panes agar urutan layer tidak berantakan
        map.createPane('pane_Base'); 
        map.createPane('pane_MCE'); map.getPane('pane_MCE').style.zIndex = 401;
        map.createPane('pane_Admin'); map.getPane('pane_Admin').style.zIndex = 402;

        // 2. Base Layers
        var googleSat = L.tileLayer('https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}', {
            pane: 'pane_Base', opacity: 1.0, attribution: 'Google'
        }).addTo(map);

        var osm = L.tileLayer('http://tile.osm.org/{z}/{x}/{y}.png', {
            pane: 'pane_Base', opacity: 1.0
        });

        // 3. Import Data Vektor dengan Fungsi Styling Anda
        function styleMCE(feature) {
            let colors = { '1':'#d7191c', '2':'#fdae61', '3':'#ffffbf', '4':'#abdeb4', '5':'#2b83ba' };
            return {
                pane: 'pane_MCE', stroke: false, fill: true, fillOpacity: 0.8,
                fillColor: colors[String(feature.properties['DN'])] || '#ccc',
                interactive: true
            };
        }

        var layerMCE = new L.geoJson(json_MultiCriteriaEvaluationSurakarta_3, {
            pane: 'pane_MCE',
            style: styleMCE,
            onEachFeature: function(feature, layer) {
                layer.bindPopup('<b>DN:</b> ' + feature.properties['DN']);
            }
        }).addTo(map);

        var layerAdmin = new L.geoJson(json_BatasAdminSurakarta_5, {
            pane: 'pane_Admin',
            style: { color: 'white', weight: 1.5, fillOpacity: 0.1, dashArray: '5,5' }
        }).addTo(map);

        // 4. FITUR SWIPE (Side-by-Side)
        // Membandingkan OSM (Kiri) vs Google Satellite + Data (Kanan)
        osm.addTo(map);
        L.control.sideBySide(osm, [googleSat, layerMCE]).addTo(map);

        // 5. Tambahkan Kontrol Standar di Kanan
        L.control.zoom({ position: 'topright' }).addTo(map);
        L.control.locate({ position: 'topright' }).addTo(map);

    </script>
    </body>
</html>
